// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// ğŸ“¦ é’±åŒ…åœ°å€æ ¼å¼åŒ–å·¥å…·
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

/**
 * ğŸ¯ ä»€ä¹ˆæ˜¯é’±åŒ…åœ°å€ï¼Ÿ
 *
 * é’±åŒ…åœ°å€æ˜¯åŒºå—é“¾ä¸Šçš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç±»ä¼¼äºé“¶è¡Œè´¦å·
 * ä¸åŒé“¾çš„åœ°å€æ ¼å¼ï¼š
 * - ä»¥å¤ªåŠ (Ethereum): 0x å¼€å¤´ï¼Œ42 ä½ (0x + 40ä¸ªåå…­è¿›åˆ¶å­—ç¬¦)
 *   ä¾‹å¦‚: 0x1234567890abcdef1234567890abcdef12345678
 *
 * - æ¯”ç‰¹å¸ (Bitcoin): 1/3/bc1 å¼€å¤´ï¼Œ26-42 ä½
 *   ä¾‹å¦‚: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa
 *
 * - Solana: 32-44 ä½ Base58 ç¼–ç 
 *   ä¾‹å¦‚: 7EqQdEUaxGkzPfHpJTbcS4H8LZNQXiVmZvKmQQqQqQqQ
 *
 * ğŸ“š ä¸ºä»€ä¹ˆè¦æ ¼å¼åŒ–ï¼Ÿ
 * 1. åœ°å€å¤ªé•¿ï¼Œåœ¨ UI ä¸Šæ˜¾ç¤ºä¸å‹å¥½
 * 2. ç”¨æˆ·åªéœ€è¦çœ‹åˆ°åœ°å€çš„å¼€å¤´å’Œç»“å°¾å³å¯è¯†åˆ«
 * 3. èŠ‚çœå±å¹•ç©ºé—´
 *
 * å¸¸è§æ ¼å¼ï¼š
 * - å®Œæ•´: 0x1234567890abcdef1234567890abcdef12345678
 * - çœç•¥: 0x1234...5678
 */

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// ğŸ“ TypeScript ç±»å‹å®šä¹‰
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

/**
 * æ ¼å¼åŒ–é€‰é¡¹
 */
export interface FormatAddressOptions {
  /**
   * å‰ç¼€ä¿ç•™å­—ç¬¦æ•°
   * @default 6
   *
   * ğŸ“– è¯´æ˜ï¼š
   * - ä»¥å¤ªåŠåœ°å€: 0x1234... â†’ ä¿ç•™ 6 ä½åŒ…å« 0x
   * - å»ºè®® 4-8 ä½ï¼Œå¤ªå°‘ä¸æ˜“è¯†åˆ«ï¼Œå¤ªå¤šå¤±å»æ ¼å¼åŒ–æ„ä¹‰
   */
  prefixLength?: number;

  /**
   * åç¼€ä¿ç•™å­—ç¬¦æ•°
   * @default 4
   *
   * ğŸ“– è¯´æ˜ï¼š
   * - ...5678 â†’ ä¿ç•™ 4 ä½
   * - é€šå¸¸æ¯” prefix å°‘ä¸€äº›
   */
  suffixLength?: number;

  /**
   * ä¸­é—´çœç•¥ç¬¦å·
   * @default '...'
   *
   * ğŸ“– è¯´æ˜ï¼š
   * - å¯ä»¥ä½¿ç”¨ '...'ã€'â€¦'ã€'****' ç­‰
   */
  ellipsis?: string;
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// ğŸ¨ æ ¼å¼åŒ–å‡½æ•°å®ç°
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

/**
 * æ ¼å¼åŒ–é’±åŒ…åœ°å€
 *
 * @param address - å®Œæ•´çš„é’±åŒ…åœ°å€
 * @param options - æ ¼å¼åŒ–é€‰é¡¹
 * @returns æ ¼å¼åŒ–åçš„åœ°å€
 *
 * ğŸ’¡ å®ç°åŸç†ï¼š
 * 1. å‚æ•°éªŒè¯ï¼šæ£€æŸ¥åœ°å€æ˜¯å¦æœ‰æ•ˆ
 * 2. é•¿åº¦åˆ¤æ–­ï¼šå¦‚æœåœ°å€å¤ŸçŸ­ï¼Œç›´æ¥è¿”å›
 * 3. å­—ç¬¦ä¸²åˆ‡å‰²ï¼šæå–å‰ç¼€å’Œåç¼€
 * 4. æ‹¼æ¥ç»“æœï¼šprefix + ellipsis + suffix
 *
 * ğŸ“– ä½¿ç”¨ç¤ºä¾‹ï¼š
 * ```ts
 * // åŸºç¡€ç”¨æ³•
 * formatAddress('0x1234567890abcdef1234567890abcdef12345678')
 * // â†’ '0x1234...5678'
 *
 * // è‡ªå®šä¹‰é•¿åº¦
 * formatAddress('0x1234567890abcdef1234567890abcdef12345678', {
 *   prefixLength: 8,
 *   suffixLength: 6
 * })
 * // â†’ '0x123456...345678'
 *
 * // è‡ªå®šä¹‰çœç•¥ç¬¦
 * formatAddress('0x1234567890abcdef1234567890abcdef12345678', {
 *   ellipsis: '****'
 * })
 * // â†’ '0x1234****5678'
 * ```
 */
export function formatAddress(address: string, options: FormatAddressOptions = {}): string {
  // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  // 1ï¸âƒ£ å‚æ•°å¤„ç†å’ŒéªŒè¯
  // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  /**
   * è§£æ„é»˜è®¤å€¼
   *
   * ğŸ” ä½¿ç”¨ ES6 è§£æ„èµ‹å€¼ + é»˜è®¤å€¼è¯­æ³•
   * - å¦‚æœ options.prefixLength å­˜åœ¨ï¼Œä½¿ç”¨å®ƒ
   * - å¦åˆ™ä½¿ç”¨é»˜è®¤å€¼ 6
   */
  const { prefixLength = 6, suffixLength = 4, ellipsis = '...' } = options;

  /**
   * å‚æ•°éªŒè¯
   *
   * ğŸ“– éªŒè¯è§„åˆ™ï¼š
   * 1. address å¿…é¡»æ˜¯å­—ç¬¦ä¸²
   * 2. address ä¸èƒ½ä¸ºç©º
   * 3. address é•¿åº¦å¿…é¡»è¶³å¤Ÿ
   *
   * âš ï¸ ä¸ºä»€ä¹ˆè¦éªŒè¯ï¼Ÿ
   * - é˜²æ­¢ä¼ å…¥ nullã€undefined å¯¼è‡´è¿è¡Œæ—¶é”™è¯¯
   * - æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
   * - é¿å…æ— æ„ä¹‰çš„æ ¼å¼åŒ–
   */
  if (!address || typeof address !== 'string') {
    /**
     * è¾¹ç•Œæƒ…å†µå¤„ç†
     *
     * ğŸ’¡ ç­–ç•¥é€‰æ‹©ï¼š
     * - æ–¹æ¡ˆ A: æŠ›å‡ºé”™è¯¯ throw new Error('Invalid address')
     * - æ–¹æ¡ˆ B: è¿”å›ç©ºå­—ç¬¦ä¸² return ''
     * - æ–¹æ¡ˆ C: è¿”å›åŸå€¼ return address
     *
     * âœ… è¿™é‡Œé€‰æ‹©è¿”å›ç©ºå­—ç¬¦ä¸²
     * - ä¸ä¼šä¸­æ–­ç¨‹åºæ‰§è¡Œ
     * - UI æ˜¾ç¤ºå‹å¥½
     * - ç¬¦åˆé˜²å¾¡æ€§ç¼–ç¨‹åŸåˆ™
     */
    return '';
  }

  // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  // 2ï¸âƒ£ é•¿åº¦åˆ¤æ–­ï¼šåœ°å€å¤ªçŸ­æ— éœ€æ ¼å¼åŒ–
  // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  /**
   * è®¡ç®—æ ¼å¼åŒ–åçš„æœ€å°é•¿åº¦
   *
   * ğŸ“ å…¬å¼ï¼šprefix + ellipsis + suffix
   * ä¾‹å¦‚ï¼š6 + 3 + 4 = 13
   *
   * ğŸ“– é€»è¾‘ï¼š
   * å¦‚æœåŸå§‹åœ°å€é•¿åº¦ <= æ ¼å¼åŒ–åçš„é•¿åº¦ï¼Œè¯´æ˜æ ¼å¼åŒ–æ²¡æœ‰æ„ä¹‰
   *
   * ç¤ºä¾‹ï¼š
   * address = '0x1234' (é•¿åº¦ 6)
   * minLength = 6 + 3 + 4 = 13
   * 6 <= 13ï¼Œç›´æ¥è¿”å› '0x1234'
   */
  const minLength = prefixLength + ellipsis.length + suffixLength;

  if (address.length <= minLength) {
    /**
     * åœ°å€å¤ªçŸ­ï¼Œç›´æ¥è¿”å›åŸå€¼
     *
     * ğŸ’¡ ä¸ºä»€ä¹ˆï¼Ÿ
     * - æ ¼å¼åŒ–ååè€Œæ›´é•¿ï¼š'0x1234' â†’ '0x1234...1234'
     * - å¤±å»äº†æ ¼å¼åŒ–çš„æ„ä¹‰ï¼ˆèŠ‚çœç©ºé—´ï¼‰
     */
    return address;
  }

  // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  // 3ï¸âƒ£ å­—ç¬¦ä¸²åˆ‡å‰²ï¼šæå–å‰ç¼€å’Œåç¼€
  // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  /**
   * æå–å‰ç¼€
   *
   * ğŸ” String.prototype.slice(start, end)
   * - start: èµ·å§‹ç´¢å¼•ï¼ˆåŒ…å«ï¼‰
   * - end: ç»“æŸç´¢å¼•ï¼ˆä¸åŒ…å«ï¼‰
   *
   * ğŸ“– ç¤ºä¾‹ï¼š
   * address = '0x1234567890abcdef'
   * address.slice(0, 6) â†’ '0x1234'
   *
   * ç´¢å¼•å¯¹åº”ï¼š
   * 0x1234567890abcdef
   * 0 1 2 3 4 5
   * â””â”€â”€â”€â”€â”€â”˜
   *  slice(0, 6)
   */
  const prefix = address.slice(0, prefixLength);

  /**
   * æå–åç¼€
   *
   * ğŸ” è´Ÿæ•°ç´¢å¼•çš„å¦™ç”¨
   * - slice(-4) è¡¨ç¤ºä»å€’æ•°ç¬¬ 4 ä¸ªå­—ç¬¦å¼€å§‹
   * - ç­‰ä»·äº slice(length - 4)
   *
   * ğŸ“– ç¤ºä¾‹ï¼š
   * address = '0x1234567890abcdef'
   * address.slice(-4) â†’ 'cdef'
   *
   * ç´¢å¼•å¯¹åº”ï¼š
   * 0x1234567890abcdef
   *               â””â”€â”€â”€â”˜
   *           slice(-4)
   */
  const suffix = address.slice(-suffixLength);

  // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  // 4ï¸âƒ£ æ‹¼æ¥å¹¶è¿”å›ç»“æœ
  // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  /**
   * ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²æ‹¼æ¥
   *
   * ğŸ“– ç»“æœï¼š
   * '0x1234' + '...' + 'cdef' = '0x1234...cdef'
   *
   * ğŸ’¡ ä¸ºä»€ä¹ˆç”¨æ¨¡æ¿å­—ç¬¦ä¸²ï¼Ÿ
   * - å¯è¯»æ€§é«˜
   * - æ€§èƒ½å¥½ï¼ˆç°ä»£ JS å¼•æ“ä¼˜åŒ–ï¼‰
   * - æ˜“äºç»´æŠ¤
   *
   * æ›¿ä»£æ–¹æ¡ˆï¼š
   * - å­—ç¬¦ä¸²æ‹¼æ¥: prefix + ellipsis + suffix
   * - æ•°ç»„ join: [prefix, ellipsis, suffix].join('')
   */
  return `${prefix}${ellipsis}${suffix}`;
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// ğŸ” é«˜çº§ç”¨æ³•å’Œæœ€ä½³å®è·µ
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

/**
 * ğŸ“š å¸¸è§ä½¿ç”¨åœºæ™¯
 *
 * 1ï¸âƒ£ React ç»„ä»¶ä¸­æ˜¾ç¤ºé’±åŒ…åœ°å€
 * ```tsx
 * function WalletAddress({ address }: { address: string }) {
 *   return (
 *     <div className="wallet-address">
 *       {formatAddress(address)}
 *     </div>
 *   );
 * }
 * ```
 *
 * 2ï¸âƒ£ è¡¨æ ¼ä¸­æ˜¾ç¤ºåœ°å€åˆ—
 * ```tsx
 * const columns = [
 *   {
 *     title: 'é’±åŒ…åœ°å€',
 *     dataIndex: 'address',
 *     render: (address: string) => formatAddress(address, {
 *       prefixLength: 8,
 *       suffixLength: 6
 *     })
 *   }
 * ];
 * ```
 *
 * 3ï¸âƒ£ å¯ç‚¹å‡»å¤åˆ¶çš„åœ°å€
 * ```tsx
 * function CopyableAddress({ address }: { address: string }) {
 *   const handleCopy = () => {
 *     navigator.clipboard.writeText(address);
 *   };
 *
 *   return (
 *     <span
 *       onClick={handleCopy}
 *       title={address} // æ‚¬åœæ˜¾ç¤ºå®Œæ•´åœ°å€
 *     >
 *       {formatAddress(address)}
 *     </span>
 *   );
 * }
 * ```
 *
 * 4ï¸âƒ£ å“åº”å¼æ˜¾ç¤ºï¼ˆç§»åŠ¨ç«¯æ˜¾ç¤ºæ›´çŸ­ï¼‰
 * ```tsx
 * function ResponsiveAddress({ address }: { address: string }) {
 *   const isMobile = useMediaQuery('(max-width: 768px)');
 *
 *   return (
 *     <span>
 *       {formatAddress(address, {
 *         prefixLength: isMobile ? 4 : 6,
 *         suffixLength: isMobile ? 3 : 4
 *       })}
 *     </span>
 *   );
 * }
 * ```
 */

/**
 * ğŸ”¥ æ€§èƒ½ä¼˜åŒ–å»ºè®®
 *
 * 1ï¸âƒ£ åœ¨å¤§åˆ—è¡¨ä¸­ä½¿ç”¨ React.memo
 * ```tsx
 * const AddressItem = React.memo(({ address }: { address: string }) => {
 *   return <div>{formatAddress(address)}</div>;
 * });
 * ```
 *
 * 2ï¸âƒ£ é¢„å…ˆæ ¼å¼åŒ–æ•°æ®
 * ```ts
 * // âŒ ä¸å¥½ï¼šæ¯æ¬¡æ¸²æŸ“éƒ½æ ¼å¼åŒ–
 * {addresses.map(addr => <div>{formatAddress(addr)}</div>)}
 *
 * // âœ… å¥½ï¼šé¢„å¤„ç†æ•°æ®
 * const formattedAddresses = useMemo(
 *   () => addresses.map(formatAddress),
 *   [addresses]
 * );
 * {formattedAddresses.map(addr => <div>{addr}</div>)}
 * ```
 */

/**
 * âš ï¸ æ³¨æ„äº‹é¡¹
 *
 * 1. æ­¤å‡½æ•°åªåšæ ¼å¼åŒ–æ˜¾ç¤ºï¼Œä¸éªŒè¯åœ°å€åˆæ³•æ€§
 *    å¦‚éœ€éªŒè¯ï¼Œè¯·ä½¿ç”¨ web3.utils.isAddress() ç­‰å·¥å…·
 *
 * 2. ä¸åŒé“¾çš„åœ°å€é•¿åº¦ä¸åŒï¼Œå»ºè®®æ ¹æ®é“¾ç±»å‹è°ƒæ•´å‚æ•°
 *    - ä»¥å¤ªåŠ: 42 ä½ï¼Œå»ºè®® prefix=6, suffix=4
 *    - Solana: 32-44 ä½ï¼Œå»ºè®® prefix=8, suffix=6
 *
 * 3. åœ¨åšå›½é™…åŒ–æ—¶ï¼Œçœç•¥ç¬¦å·å¯èƒ½éœ€è¦æœ¬åœ°åŒ–
 *    - è‹±æ–‡: '...'
 *    - ä¸­æ–‡: 'â€¦'
 */
